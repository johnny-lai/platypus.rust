# Example configuration file for platypus server

# You can have more than one routes
# Each ro∑¡™utes should apply to non-overlapping prefixes
[routes.instance]
routes = [
  { match = "^echo1/(?<path>.+)", to = "echo1" },
  { match = "^echo2/(?<path>.+)", to = "echo2" },
  { match = "^both/(?<path>.+)", to = "both" },

  { match = "^secrets1/(?<path>.+)", to = "secrets1" },
]

[source.echo1]
type = "echo"
template = "echo1 = {path}"

[source.echo2]
type = "echo"
template = "echo2 = {path}"

[source.both]
type = "merge"
format = "json"
template = [
  { key = [ "echo1" ], source = "echo1", args = { inherit = {} } }, # args is inherited
  { key = [ "echo2" ], source = "echo2", args = { replace = { path = "{path}" } } },
]

[source.secrets1]
type = "aws_secrets_manager"
secret_id = "dev/secrets1/{path}"
pool = "awssm"

[pool.awssm]
type = "aws_secrets_manager"
min_idle = 1
max_size = 10
